# Build Log â€” 2026-02-09 (PST)

## Summary
- Created live gap checklist and updated plan/notes for vertical-slice execution.
- Added a one-click production docker compose launcher that wraps the full stack startup script.
- Documented the prod launcher in Quickstart and docker compose notes.
- Added tests that verify the prod launcher exists, is executable, and calls the full stack script.
- Moved voice services (stt/tts) to an optional voice profile to avoid prod startup failures when images are unavailable.
- Added a --voice flag to start-stack-full.sh and documented voice enablement.
- Added tests to ensure voice services are opt-in and the --voice flag is wired.
- Switched STT image to linuxserver/faster-whisper (available) and mapped port 9000 -> 10300.
- Documented voice profile defaults and female TTS voice.
- Pinned docker compose file path in `start-stack-full.sh` to avoid `COMPOSE_FILE` overrides during prod startup.
- Set prod TTS default to `en-us-blizzard_lessac` and added regression tests for compose pinning + TTS voice.
- Added agent policy + graph refinement settings to backend settings API and frontend settings panel.
- Added missing API models (automation, courts, storyboard, timeline exports, legal framework, sandbox request) to unblock app import.
- Hardened DB auto-init to warn and continue if Postgres is unreachable.
- Replaced ad-hoc mTLS middleware with MTLSMiddleware for authenticated endpoints.
- Added graph refinement swarm status/restart panel to CENTCOM.

## Files
- docs/plans/2026-02-09_gap_checklist_live.md
- task_plan.md
- notes.md
- scripts/run-prod.sh
- scripts/README-docker-compose.md
- docs/QUICKSTART.md
- backend/tests/test_prod_run_script.py
- docker-compose.yml
- scripts/start-stack-full.sh
- backend/tests/test_docker_compose_voice_profile.py
- docs/QUICKSTART.md
- scripts/README-docker-compose.md
- backend/tests/test_start_stack_full_script.py
- backend/tests/test_prod_env_voice.py
- infra/profiles/prod.env
- backend/app/models/api.py
- backend/app/services/settings.py
- backend/app/config.py
- backend/app/agents/swarms_orchestrator.py
- backend/tests/test_settings.py
- backend/tests/conftest.py
- backend/app/main.py
- frontend/src/types.ts
- frontend/src/components/SettingsPanel.tsx
- frontend/src/components/__tests__/SettingsPanel.test.tsx
- frontend/src/services/graph_refinement_api.ts
- frontend/src/pages/CentcomWarRoomPage.tsx

## Commands
- pytest backend/tests/test_prod_run_script.py -q
- PYTHONPATH=/Volumes/MAC_DEV/REPOS/2-4-26_tree/co-counsel_final/tools pytest backend/tests/test_prod_run_script.py -q
- python -m pip install coverage==7.6.4
- PYTHONPATH=/Volumes/MAC_DEV/REPOS/2-4-26_tree/co-counsel_final/tools coverage run -m pytest backend/tests/test_prod_run_script.py -q
- coverage report -m
- PYTHONPATH=/Volumes/MAC_DEV/REPOS/2-4-26_tree/co-counsel_final/tools pytest backend/tests/test_docker_compose_voice_profile.py -q
- PYTHONPATH=/Volumes/MAC_DEV/REPOS/2-4-26_tree/co-counsel_final/tools coverage run -m pytest backend/tests/test_docker_compose_voice_profile.py -q
- coverage report -m
- docker pull linuxserver/faster-whisper:latest
- cd /Volumes/MAC_DEV/REPOS/2-4-26_tree/co-counsel_final/backend && pytest -q tests/test_start_stack_full_script.py
- cd /Volumes/MAC_DEV/REPOS/2-4-26_tree/co-counsel_final/backend && PYTHONPATH=/Volumes/MAC_DEV/REPOS/2-4-26_tree/co-counsel_final pytest -q tests/test_start_stack_full_script.py
- cd /Volumes/MAC_DEV/REPOS/2-4-26_tree/co-counsel_final/backend && PYTHONPATH=/Volumes/MAC_DEV/REPOS/2-4-26_tree/co-counsel_final pytest -q tests/test_start_stack_full_script.py tests/test_prod_env_voice.py
- PYTHONPATH=/Volumes/MAC_DEV/REPOS/2-4-26_tree/co-counsel_final python - <<'PY' ... import backend.app.main ...
- cd /Volumes/MAC_DEV/REPOS/2-4-26_tree/co-counsel_final/backend && PYTHONPATH=/Volumes/MAC_DEV/REPOS/2-4-26_tree/co-counsel_final pytest -q tests/test_settings.py
- cd /Volumes/MAC_DEV/REPOS/2-4-26_tree/co-counsel_final/frontend && npm test -- --run src/components/__tests__/SettingsPanel.test.tsx
- pkill -f vitest

## Notes
- Removed UTF-8 BOM from `backend/app/main.py` to avoid patch context mismatches (`diffhunksrenderer.processdiffresult`).
