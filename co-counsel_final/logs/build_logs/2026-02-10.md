# Build Log - 2026-02-10

## Summary
- Removed UTF-8 BOM from `backend/app/main.py` to resolve patch context mismatches.
- Added `STT_IMAGE` / `TTS_IMAGE` overrides in docker compose for voice services.
- Added one-click full prod script (`scripts/run-prod-full.sh`) and documented usage.
- Hardened compose startup by unsetting `COMPOSE_FILE` / `COMPOSE_PROFILES` in `start-stack-full.sh`.
- Aligned Helm values to use `linuxserver/faster-whisper:latest`.
- Verified `scripts/README-docker-compose.md` uses ASCII/LF; patch mismatch likely due to stale context.
- Added auto-run automation trigger after ingestion completion (scheduled pipeline).
- Inventoried legacy `toolsnteams_previous` mappings.
- Added Swarms legacy workflow tools + team routing (drafting, deposition, subpoena, discovery, trial prep).
- Removed redundant `SwarmsOrchestrator` import in `backend/app/agents/runner.py` to prevent patch context drift.
- Added `/agents/run` + thread read endpoints (AgentsService-backed) for panel-driven swarm runs.
- Built Trial Prep Hub panels (deposition, subpoena, discovery, trial prep) + drafting upgrades.
- Added `agents_api` frontend service and UI styling for new panels.
- Set `STT_IMAGE` / `TTS_IMAGE` defaults in profile env files; updated TTS voice to `en-us-amy-low` (compose default aligned).
- Implemented Presentation Studio: binder library, exhibit deck ordering, in-court mode, and exports.
- Rewired Evidence Binder manager to use real API endpoints with demo fallback.
- ui-ux-pro-max script path unresolved; used existing cinematic design system defaults.

## Files Touched
- backend/app/main.py
- docker-compose.yml
- infra/helm/full-stack/values.yaml
- scripts/start-stack-full.sh
- scripts/run-prod-full.sh
- scripts/README-docker-compose.md
- docs/QUICKSTART.md
- task_plan.md
- logs/build_logs/2026-02-09.md
- infra/profiles/prod.env
- infra/profiles/dev.env
- backend/app/services/ingestion.py
- backend/tests/test_ingestion_auto_workflow.py
- docs/plans/2026-02-10_toolsnteams_inventory.md
- docs/plans/2026-02-07_swarms_parity_matrix.md
- docs/plans/2026-02-09_gap_checklist_live.md
- docs/plans/2026-02-07_master_task_list.md
- notes.md
- backend/app/agents/tools/legacy_workflows.py
- backend/app/agents/teams/legacy_teams.py
- backend/app/agents/runner.py
- backend/app/api/agents.py
- frontend/src/services/agents_api.ts
- frontend/src/pages/TrialPrepHubPage.tsx
- frontend/src/pages/DocumentDraftingPage.tsx
- frontend/src/components/Layout.tsx
- frontend/src/App.tsx
- frontend/src/styles/index.css
- frontend/src/pages/InCourtPresentationPage.tsx
- frontend/src/components/EvidenceBinder/EvidenceBinderManager.tsx
- frontend/src/services/evidence_binder_api.ts
- docs/plans/2026-02-10-presentation-studio-design.md
- backend/tests/test_team_routing.py
- backend/tests/test_legacy_team_builders.py

## Commands
- xxd -g 1 -l 8 backend/app/main.py
- python - <<'PY' (BOM removal)
- chmod +x scripts/run-prod-full.sh
- cat /Users/house/.agents/skills/ui-ux-pro-max/scripts (path check)

## Tests
- Not run in this pass.

## Update - Research & Strategy Hub
- Added Research & Strategy Hub UI (research, theory, strategy panels) with swarm + index triggers.
- Added new route `/research-strategy` and navigation item.
- Added Research hub CSS styles.
- Normalized agents API routes to `/agents/run`, `/agents/invoke`, `/agents/threads` and fixed missing ReasoningResponse return.
- Hardened voice image env usage by unsetting STT/TTS overrides before compose run.

## Update - Ref7-Ref13 + Stitch-3 Theme
- Parsed ref7-ref17 and extracted UI motifs (neon cyan/gold, glass panels, rim-lit cards, grain + starfield).
- Unpacked stitch-3 bundle into frontend/design_refs/stitch-3 for ongoing UI reference.
- Applied global theme adjustments (fonts, palette, grain/grid overlay, glass panels) to match ref7-13 visual system.

## Update - Global Theme Pass (Ref7-13)
- Replaced emoji UI icons with Font Awesome (dashboard actions, theme toggle, upload).
- Restyled dashboard, timeline, and research panels to match glass + neon cyan/gold spec.
- Adjusted timeline buttons/filters/inspector to mono labels + glass panels.

## Update - Trial Prep + Presentation Theme Pass
- Updated trial prep and presentation studio panels to match ref7-13 glass + neon cyan/gold treatment.
- Refined input fields, labels, and progress gradients to align with mono micro-label styling.
- Removed AppleDouble (._*) files and added `.dockerignore` to backend/frontend to prevent docker build xattr failures.
- Forced known-good STT/TTS defaults in `scripts/start-stack-full.sh` (linuxserver/faster-whisper + Larynx Amy voice).
- Refreshed Service of Process UI panel with cinematic glass styling and status pills.
- Added Graph Query Builder panel to the 3D Graph Explorer with Cypher input + demo fallback.
- Added local Coqui TTS backend with `TTS_BACKEND` switch for more natural voice (default local).
- Added vision analyzer for ingestion images and wired vision metadata into pipeline tags/categories.

## Update - Module Override Controls
- Expanded Settings providers panel with per-module provider + model overrides (chat + advanced embeddings/vision).
- Added hybrid module catalog fallback and advanced toggle UI for overrides.
- Removed emoji icon from settings trigger and added halo-styled controls.
- Documented module override UI design (`docs/plans/2026-02-10-module-override-settings-design.md`).

## Update - UI Polish Pass (Presentation, Timeline, Research, Graph)
- Refined In-Court Presentation HUD, presenter notes, and courtroom checklist.
- Added topic/subject + evidence source filters for timeline (frontend + backend).
- Structured Research/Strategy outputs with signal stacks, argument maps, and citation cards.
- Added graph query evidence links + cinematic atmosphere polish in Graph Explorer.
- Documented UI polish design (`docs/plans/2026-02-10-ui-polish-pass.md`).
